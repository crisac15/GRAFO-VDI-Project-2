---
title: "Visualización de Requisitos y Correquisitos"
output: html_document
---

```{r setup, include=FALSE}
library(visNetwork)
library(dplyr)
library(readr)
```

## R Markdown

```{r}
# Leer nodos (cursos) y aristas (relaciones)
nodos <- read_csv("plan_computadores_nodos.csv")
aristas <- read_csv("plan_computadores_aristas.csv")

# Asignar un ID numérico único a cada curso
nodos$id <- 1:nrow(nodos)
sigla_to_id <- setNames(nodos$id, nodos$sigla)

```

## R Markdown

```{r}
# Requisitos: aristas dirigidas
dirigidas <- aristas %>%
  filter(tipo == "requisito") %>%
  mutate(from = sigla_to_id[origen],
         to = sigla_to_id[destino],
         arrows = "to")

# Correquisitos: aristas no dirigidas (bidireccionales)
correquisitos <- aristas %>%
  filter(tipo == "correquisito") %>%
  mutate(from = sigla_to_id[origen],
         to = sigla_to_id[destino],
         arrows = "") %>%
  bind_rows(
    mutate(., from = to, to = from)  # hacerlas bidireccionales
  )

# Unir todos los enlaces
aristas_final <- bind_rows(dirigidas, correquisitos)

```

## R Markdown
```{r}
nodos_vis <- nodos %>%
  rename(label = sigla) %>%
  mutate(
    title = paste(label, "-", nombre),
    value = horas,                # Tamaño proporcional a cantidad de horas
    group = area,                 # Grupo por área disciplinaria
    shape = ifelse(creditos >= 4, "box", "ellipse")  # Forma según créditos
  )

```

## R Markdown

```{r}
visNetwork(nodos_vis, aristas_final) %>%
  visNodes(font = list(size = 16)) %>%
  visEdges(smooth = FALSE) %>%
  visOptions(
    highlightNearest = TRUE,                         # Resaltar nodos adyacentes
    selectedBy = list(variable = "label"),           # Selección por sigla
    nodesIdSelection = TRUE                          # Buscador
  ) %>%
  visLegend() %>%
  visGroups(groupname = unique(nodos_vis$group)) %>%
  visInteraction(navigationButtons = TRUE)           # Pan y Zoom

```
